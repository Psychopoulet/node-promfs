"use strict";function _extractRealFiles(e,n,r,t){0>=n.length?t(null,r):!function(){var i=path.join(e,n.shift()).trim();fs.isFile(i,function(o,f){o?t(o):(f&&r.push(i),_extractRealFiles(e,n,r,t))})}()}function _readContent(e,n,r,t,i){0>=e.length?i(null,t):!function(){var o=e.shift().trim();fs.isFile(o,function(f,c){f?i(f):c?fs.readFile(o,n,function(f,c){f?i(f):-1<r.indexOf("{{filename}}")?_readContent(e,n,r,t+r.replace("{{filename}}",path.basename(o))+c,i):_readContent(e,n,r,""===t?c:t+r+c,i)}):i(new Error('"'+o+'" does not exist'))})}()}function _concatContentStream(e,n,r,t,i){0>=n.length?i(null):!function(){var o=n.shift().trim();fs.isFile(o,function(f,c){f?i(f):c?e.write(-1<t.indexOf("{{filename}}")?t.replace("{{filename}}",path.basename(o)):"","utf8",function(f){f?i(f):!function(){var f=fs.createReadStream(o),c=!1;f.once("error",function(e){c=!0,f.close(),i(e)}).once("open",function(){f.pipe(e,{end:!1})}).once("close",function(){c||(0>=n.length?i(null):-1<t.indexOf("{{filename}}")?_concatContentStream(e,n,r,t,i):e.write(t,function(o){o?i(o):_concatContentStream(e,n,r,t,i)}))}).once("end",function(){f.close()})}()}):i(new Error('"'+o+'" is not a valid file'))})}()}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},path=require("path"),fs=require(path.join(__dirname,"extends_native.js"));fs.extractFilesSync=function(e){if("undefined"==typeof e)throw new ReferenceError("missing 'directory' argument");if("string"!=typeof e)throw new TypeError("'directory' argument is not a string");if(e=e.trim(),!fs.isDirectorySync(e))throw new Error("'"+e+"' is not a valid directory");var n=function(){var n=[];return fs.readdirSync(e).forEach(function(r){r=path.join(e,r),fs.isFileSync(r)&&n.push(r)}),{v:n}}();if("object"===("undefined"==typeof n?"undefined":_typeof(n)))return n.v},fs.extractFiles=function(e,n){if("undefined"==typeof e)throw new ReferenceError("missing 'directory' argument");if("string"!=typeof e)throw new TypeError("'directory' argument is not a string");if("undefined"==typeof n)throw new ReferenceError("missing 'callback' argument");if("function"!=typeof n)throw new TypeError("'callback' argument is not a function");e=e.trim(),fs.isDirectory(e,function(r,t){r?n(r):t?fs.readdir(e,function(r,t){r?n(r):_extractRealFiles(e,t,[],function(e,r){e?n(e):n(null,r)})}):n(new Error("'"+e+"' is not a valid directory"))})},fs.filesToStringSync=function(e,n,r){if("undefined"==typeof e)throw new ReferenceError("missing 'files' argument");if(!("object"===("undefined"==typeof e?"undefined":_typeof(e))&&e instanceof Array))throw new TypeError("'files' argument is not an Array");var t=function(){n="string"==typeof n?n.trim():null,r="string"==typeof r?r:" ";var t="";return e.forEach(function(e){if(e=e.trim(),!fs.isFileSync(e))throw new Error('"'+e+'" does not exist');t=-1<r.indexOf("{{filename}}")?t+r.replace("{{filename}}",path.basename(e))+fs.readFileSync(e,n):""===t?fs.readFileSync(e,n):t+r+fs.readFileSync(e,n)}),{v:t}}();if("object"===("undefined"==typeof t?"undefined":_typeof(t)))return t.v},fs.filesToString=function(e,n,r,t){if("undefined"==typeof e)throw new ReferenceError("missing 'files' argument");if(!("object"===("undefined"==typeof e?"undefined":_typeof(e))&&e instanceof Array))throw new TypeError("'files' argument is not an Array");if("undefined"==typeof t&&"undefined"==typeof r&&"undefined"==typeof n)throw new ReferenceError("missing 'callback' argument");if("function"!=typeof t&&"function"!=typeof r&&"function"!=typeof n)throw new TypeError("'callback' argument is not a function");"undefined"==typeof t&&(t="undefined"==typeof r?n:r),n="string"==typeof n?n.trim():"utf8",r="string"==typeof r?r:" ",_readContent(e,n,r,"",function(e,n){e?t(e):t(null,n)})},fs.filesToFileSync=function(e,n,r){if("undefined"==typeof e)throw new ReferenceError("missing 'files' argument");if(!("object"===("undefined"==typeof e?"undefined":_typeof(e))&&e instanceof Array))throw new TypeError("'files' argument is not an Array");if("undefined"==typeof n)throw new ReferenceError("missing 'target' argument");if("string"!=typeof n)throw new TypeError("'target' argument is not a string");if(n=n.trim(),""===n)throw new Error("'target' argument is empty");r="string"==typeof r?r:" ",fs.isFileSync(n)&&fs.unlinkSync(n),fs.writeFileSync(n,""),e.forEach(function(e,t){if(e=e.trim(),!fs.isFileSync(e))throw new Error('"'+e+'" does not exist');-1<r.indexOf("{{filename}}")?fs.appendFileSync(n,r.replace("{{filename}}",path.basename(e))+fs.readFileSync(e)):fs.appendFileSync(n,0<t?r+fs.readFileSync(e):fs.readFileSync(e))})},fs.filesToFile=function(e,n,r,t){if("undefined"==typeof e)throw new ReferenceError("missing 'files' argument");if(!("object"===("undefined"==typeof e?"undefined":_typeof(e))&&e instanceof Array))throw new TypeError("'files' argument is not an Array");if("undefined"==typeof n)throw new ReferenceError("missing 'target' argument");if("string"!=typeof n)throw new TypeError("'target' argument is not a string");if("undefined"==typeof t&&"undefined"==typeof r)throw new ReferenceError("missing 'callback' argument");if("function"!=typeof t&&"function"!=typeof r)throw new TypeError("'callback' argument is not a function");if("undefined"==typeof t&&(t=r),n=n.trim(),""===n)throw new Error("'target' argument is empty");r="string"==typeof r?r:" ",new Promise(function(e,r){fs.isFile(n,function(t,i){t?r(t):i?fs.unlink(n,function(n){n?r(n):e()}):e()})}).then(function(){return new Promise(function(e,r){fs.writeFile(n,"",function(n){n?r(n):e()})})}).then(function(){var i=fs.createWriteStream(n,{flags:"a"}),o=!1;i.once("error",function(e){o=!0,i.close(),t(e)}).once("close",function(){o||t(null)}),_concatContentStream(i,e,n,r,function(e){e&&(o=!0,t(e)),i.close()})}).catch(t)},fs.directoryToStringSync=function(e,n,r){if("undefined"==typeof e)throw new ReferenceError("missing 'directory' argument");if("string"!=typeof e)throw new TypeError("'directory' argument is not a string");return fs.filesToStringSync(fs.extractFilesSync(e),n,r)},fs.directoryToString=function(e,n,r,t){if("undefined"==typeof e)throw new ReferenceError("missing 'directory' argument");if("string"!=typeof e)throw new TypeError("'directory' argument is not a string");if("undefined"==typeof t&&"undefined"==typeof r&&"undefined"==typeof n)throw new ReferenceError("missing 'callback' argument");if("function"!=typeof t&&"function"!=typeof r&&"function"!=typeof n)throw new TypeError("'callback' argument is not a function");"undefined"==typeof t&&(t="undefined"==typeof r?n:r),fs.extractFiles(e,function(e,i){e?t(e):fs.filesToString(i,n,r,function(e,n){e?t(e):t(null,n)})})},fs.directoryToFileSync=function(e,n,r){if("undefined"==typeof e)throw new ReferenceError("missing 'directory' argument");if("string"!=typeof e)throw new TypeError("'directory' argument is not a string");if("undefined"==typeof n)throw new ReferenceError("missing 'target' argument");if("string"!=typeof n)throw new TypeError("'target' argument is not a string");if(n=n.trim(),""===n)throw new Error("'target' argument is empty");return fs.filesToFileSync(fs.extractFilesSync(e),n,r)},fs.directoryToFile=function(e,n,r,t){if("undefined"==typeof e)throw new ReferenceError("missing 'directory' argument");if("string"!=typeof e)throw new TypeError("'directory' argument is not a string");if("undefined"==typeof n)throw new ReferenceError("missing 'target' argument");if("string"!=typeof n)throw new TypeError("'target' argument is not a string");if("undefined"==typeof t&&"undefined"==typeof r)throw new ReferenceError("missing 'callback' argument");if("function"!=typeof t&&"function"!=typeof r)throw new TypeError("'callback' argument is not a function");if(n=n.trim(),""===n)throw new Error("'target' argument is empty");"undefined"==typeof t&&(t=r),fs.extractFiles(e,function(e,i){e?t(e):fs.filesToFile(i,n,r,function(e){t(e?e:null)})})},fs.mkdirpSync=function(e){fs.isDirectorySync(e)||(fs.isDirectorySync(path.dirname(e))||fs.mkdirpSync(path.dirname(e)),fs.mkdirSync(e,parseInt("0777",8)))},fs.mkdirp=function(e,n){if("undefined"==typeof e)throw new ReferenceError("missing 'directory' argument");if("string"!=typeof e)throw new TypeError("'directory' argument is not a string");if("undefined"==typeof n)throw new ReferenceError("missing 'callback' argument");if("function"!=typeof n)throw new TypeError("'callback' argument is not a function");fs.isDirectory(e,function(r,t){r?n(r):t?n(null):fs.mkdirp(path.dirname(e),function(r){r?n(r):fs.mkdir(e,parseInt("0777",8),function(e){n(e?e:null)})})})},fs.rmdirpSync=function(e){fs.isDirectorySync(e)&&(fs.readdirSync(e).forEach(function(n){var r=path.join(e,n);fs.isDirectorySync(r)?fs.rmdirpSync(r):fs.isFileSync(r)&&fs.unlinkSync(r)}),fs.rmdirSync(e))},fs.rmdirp=function(e,n){if("undefined"==typeof e)throw new ReferenceError("missing 'directory' argument");if("string"!=typeof e)throw new TypeError("'directory' argument is not a string");if("undefined"==typeof n)throw new ReferenceError("missing 'callback' argument");if("function"!=typeof n)throw new TypeError("'callback' argument is not a function");fs.isDirectory(e,function(r,t){r?n(r):t?fs.readdir(e,function(r,t){r?n(r):0===t.length?fs.rmdir(e,function(e){e?n(e):n()}):!function(){for(var r=0,i=function(i){var o=path.join(e,t[i]);fs.isDirectory(o,function(i,f){i?n(i):f?fs.rmdirp(o,function(i){i?n(i):(++r,r>=t.length&&fs.rmdir(e,function(e){n(e?e:null)}))}):fs.unlink(o,function(i){i?n(i):(++r,r>=t.length&&fs.rmdir(e,function(e){n(e?e:null)}))})})},o=0;o<t.length;++o)i(o)}()}):n(null)})},module.exports=fs;